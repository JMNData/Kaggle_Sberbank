import os, csv, sqlite3

##Constants
cdirector = 'C:\\Users\\Mike\\Documents\\Github\\Kaggle_Sberbank'

#Setup ENvrionment
os.chdir(cdirector)

#con = sqlite3.connect(":memory:")
con = sqlite3.connect("Sberbank.db")
cur = con.cursor()

cur.execute('CREATE TABLE t (id, timestamp, full_sq, life_sq, floor, max_floor, material, build_year, num_room, kitch_sq, state, product_type, sub_area, area_m, raion_popul, green_zone_part, indust_part, children_preschool, preschool_quota, preschool_education_centers_raion, children_school, school_quota, school_education_centers_raion, school_education_centers_top_20_raion, hospital_beds_raion, healthcare_centers_raion, university_top_20_raion, sport_objects_raion, additional_education_raion, culture_objects_top_25, culture_objects_top_25_raion, shopping_centers_raion, office_raion, thermal_power_plant_raion, incineration_raion, oil_chemistry_raion, radiation_raion, railroad_terminal_raion, big_market_raion, nuclear_reactor_raion, detention_facility_raion, full_all, male_f, female_f, young_all, young_male, young_female, work_all, work_male, work_female, ekder_all, ekder_male, ekder_female, z0_6_all, z0_6_male, z0_6_female, z7_14_all, z7_14_male, z7_14_female, z0_17_all, z0_17_male, z0_17_female, z16_29_all, z16_29_male, z16_29_female, z0_13_all, z0_13_male, z0_13_female, raion_build_count_with_material_info, build_count_block, build_count_wood, build_count_frame, build_count_brick, build_count_monolith, build_count_panel, build_count_foam, build_count_slag, build_count_mix, raion_build_count_with_builddate_info, build_count_before_1920, build_count_1921_1945, build_count_1946_1970, build_count_1971_1995, build_count_after_1995, ID_metro, metro_min_avto, metro_km_avto, metro_min_walk, metro_km_walk, kindergarten_km, school_km, park_km, green_zone_km, industrial_km, water_treatment_km, cemetery_km, incineration_km, railroad_station_walk_km, railroad_station_walk_min, ID_railroad_station_walk, railroad_station_avto_km, railroad_station_avto_min, ID_railroad_station_avto, public_transport_station_km, public_transport_station_min_walk, water_km, water_1line, mkad_km, ttk_km, sadovoe_km, bulvar_ring_km, kremlin_km, big_road1_km, ID_big_road1, big_road1_1line, big_road2_km, ID_big_road2, railroad_km, railroad_1line, zd_vokzaly_avto_km, ID_railroad_terminal, bus_terminal_avto_km, ID_bus_terminal, oil_chemistry_km, nuclear_reactor_km, radiation_km, power_transmission_line_km, thermal_power_plant_km, ts_km, big_market_km, market_shop_km, fitness_km, swim_pool_km, ice_rink_km, stadium_km, basketball_km, hospice_morgue_km, detention_facility_km, public_healthcare_km, university_km, workplaces_km, shopping_centers_km, office_km, additional_education_km, preschool_km, big_church_km, church_synagogue_km, mosque_km, theater_km, museum_km, exhibition_km, catering_km, ecology, green_part_500, prom_part_500, office_count_500, office_sqm_500, trc_count_500, trc_sqm_500, cafe_count_500, cafe_sum_500_min_price_avg, cafe_sum_500_max_price_avg, cafe_avg_price_500, cafe_count_500_na_price, cafe_count_500_price_500, cafe_count_500_price_1000, cafe_count_500_price_1500, cafe_count_500_price_2500, cafe_count_500_price_4000, cafe_count_500_price_high, big_church_count_500, church_count_500, mosque_count_500, leisure_count_500, sport_count_500, market_count_500, green_part_1000, prom_part_1000, office_count_1000, office_sqm_1000, trc_count_1000, trc_sqm_1000, cafe_count_1000, cafe_sum_1000_min_price_avg, cafe_sum_1000_max_price_avg, cafe_avg_price_1000, cafe_count_1000_na_price, cafe_count_1000_price_500, cafe_count_1000_price_1000, cafe_count_1000_price_1500, cafe_count_1000_price_2500, cafe_count_1000_price_4000, cafe_count_1000_price_high, big_church_count_1000, church_count_1000, mosque_count_1000, leisure_count_1000, sport_count_1000, market_count_1000, green_part_1500, prom_part_1500, office_count_1500, office_sqm_1500, trc_count_1500, trc_sqm_1500, cafe_count_1500, cafe_sum_1500_min_price_avg, cafe_sum_1500_max_price_avg, cafe_avg_price_1500, cafe_count_1500_na_price, cafe_count_1500_price_500, cafe_count_1500_price_1000, cafe_count_1500_price_1500, cafe_count_1500_price_2500, cafe_count_1500_price_4000, cafe_count_1500_price_high, big_church_count_1500, church_count_1500, mosque_count_1500, leisure_count_1500, sport_count_1500, market_count_1500, green_part_2000, prom_part_2000, office_count_2000, office_sqm_2000, trc_count_2000, trc_sqm_2000, cafe_count_2000, cafe_sum_2000_min_price_avg, cafe_sum_2000_max_price_avg, cafe_avg_price_2000, cafe_count_2000_na_price, cafe_count_2000_price_500, cafe_count_2000_price_1000, cafe_count_2000_price_1500, cafe_count_2000_price_2500, cafe_count_2000_price_4000, cafe_count_2000_price_high, big_church_count_2000, church_count_2000, mosque_count_2000, leisure_count_2000, sport_count_2000, market_count_2000, green_part_3000, prom_part_3000, office_count_3000, office_sqm_3000, trc_count_3000, trc_sqm_3000, cafe_count_3000, cafe_sum_3000_min_price_avg, cafe_sum_3000_max_price_avg, cafe_avg_price_3000, cafe_count_3000_na_price, cafe_count_3000_price_500, cafe_count_3000_price_1000, cafe_count_3000_price_1500, cafe_count_3000_price_2500, cafe_count_3000_price_4000, cafe_count_3000_price_high, big_church_count_3000, church_count_3000, mosque_count_3000, leisure_count_3000, sport_count_3000, market_count_3000, green_part_5000, prom_part_5000, office_count_5000, office_sqm_5000, trc_count_5000, trc_sqm_5000, cafe_count_5000, cafe_sum_5000_min_price_avg, cafe_sum_5000_max_price_avg, cafe_avg_price_5000, cafe_count_5000_na_price, cafe_count_5000_price_500, cafe_count_5000_price_1000, cafe_count_5000_price_1500, cafe_count_5000_price_2500, cafe_count_5000_price_4000, cafe_count_5000_price_high, big_church_count_5000, church_count_5000, mosque_count_5000, leisure_count_5000, sport_count_5000, market_count_5000, price_doc);')
with open('data\\train.csv','rb') as fin: # `with` statement available in 2.5+
    # csv.DictReader uses first line in file for column headings by default
    dr = csv.DictReader(fin) # comma is default delimiter
    to_db = [(i['id'], i['timestamp'], i['full_sq'], i['life_sq'], i['floor'], i['max_floor'], i['material'], i['build_year'], i['num_room'], i['kitch_sq'], i['state'], i['product_type'], i['sub_area'], i['area_m'], i['raion_popul'], i['green_zone_part'], i['indust_part'], i['children_preschool'], i['preschool_quota'], i['preschool_education_centers_raion'], i['children_school'], i['school_quota'], i['school_education_centers_raion'], i['school_education_centers_top_20_raion'], i['hospital_beds_raion'], i['healthcare_centers_raion'], i['university_top_20_raion'], i['sport_objects_raion'], i['additional_education_raion'], i['culture_objects_top_25'], i['culture_objects_top_25_raion'], i['shopping_centers_raion'], i['office_raion'], i['thermal_power_plant_raion'], i['incineration_raion'], i['oil_chemistry_raion'], i['radiation_raion'], i['railroad_terminal_raion'], i['big_market_raion'], i['nuclear_reactor_raion'], i['detention_facility_raion'], i['full_all'], i['male_f'], i['female_f'], i['young_all'], i['young_male'], i['young_female'], i['work_all'], i['work_male'], i['work_female'], i['ekder_all'], i['ekder_male'], i['ekder_female'], i['0_6_all'], i['0_6_male'], i['0_6_female'], i['7_14_all'], i['7_14_male'], i['7_14_female'], i['0_17_all'], i['0_17_male'], i['0_17_female'], i['16_29_all'], i['16_29_male'], i['16_29_female'], i['0_13_all'], i['0_13_male'], i['0_13_female'], i['raion_build_count_with_material_info'], i['build_count_block'], i['build_count_wood'], i['build_count_frame'], i['build_count_brick'], i['build_count_monolith'], i['build_count_panel'], i['build_count_foam'], i['build_count_slag'], i['build_count_mix'], i['raion_build_count_with_builddate_info'], i['build_count_before_1920'], i['build_count_1921-1945'], i['build_count_1946-1970'], i['build_count_1971-1995'], i['build_count_after_1995'], i['ID_metro'], i['metro_min_avto'], i['metro_km_avto'], i['metro_min_walk'], i['metro_km_walk'], i['kindergarten_km'], i['school_km'], i['park_km'], i['green_zone_km'], i['industrial_km'], i['water_treatment_km'], i['cemetery_km'], i['incineration_km'], i['railroad_station_walk_km'], i['railroad_station_walk_min'], i['ID_railroad_station_walk'], i['railroad_station_avto_km'], i['railroad_station_avto_min'], i['ID_railroad_station_avto'], i['public_transport_station_km'], i['public_transport_station_min_walk'], i['water_km'], i['water_1line'], i['mkad_km'], i['ttk_km'], i['sadovoe_km'], i['bulvar_ring_km'], i['kremlin_km'], i['big_road1_km'], i['ID_big_road1'], i['big_road1_1line'], i['big_road2_km'], i['ID_big_road2'], i['railroad_km'], i['railroad_1line'], i['zd_vokzaly_avto_km'], i['ID_railroad_terminal'], i['bus_terminal_avto_km'], i['ID_bus_terminal'], i['oil_chemistry_km'], i['nuclear_reactor_km'], i['radiation_km'], i['power_transmission_line_km'], i['thermal_power_plant_km'], i['ts_km'], i['big_market_km'], i['market_shop_km'], i['fitness_km'], i['swim_pool_km'], i['ice_rink_km'], i['stadium_km'], i['basketball_km'], i['hospice_morgue_km'], i['detention_facility_km'], i['public_healthcare_km'], i['university_km'], i['workplaces_km'], i['shopping_centers_km'], i['office_km'], i['additional_education_km'], i['preschool_km'], i['big_church_km'], i['church_synagogue_km'], i['mosque_km'], i['theater_km'], i['museum_km'], i['exhibition_km'], i['catering_km'], i['ecology'], i['green_part_500'], i['prom_part_500'], i['office_count_500'], i['office_sqm_500'], i['trc_count_500'], i['trc_sqm_500'], i['cafe_count_500'], i['cafe_sum_500_min_price_avg'], i['cafe_sum_500_max_price_avg'], i['cafe_avg_price_500'], i['cafe_count_500_na_price'], i['cafe_count_500_price_500'], i['cafe_count_500_price_1000'], i['cafe_count_500_price_1500'], i['cafe_count_500_price_2500'], i['cafe_count_500_price_4000'], i['cafe_count_500_price_high'], i['big_church_count_500'], i['church_count_500'], i['mosque_count_500'], i['leisure_count_500'], i['sport_count_500'], i['market_count_500'], i['green_part_1000'], i['prom_part_1000'], i['office_count_1000'], i['office_sqm_1000'], i['trc_count_1000'], i['trc_sqm_1000'], i['cafe_count_1000'], i['cafe_sum_1000_min_price_avg'], i['cafe_sum_1000_max_price_avg'], i['cafe_avg_price_1000'], i['cafe_count_1000_na_price'], i['cafe_count_1000_price_500'], i['cafe_count_1000_price_1000'], i['cafe_count_1000_price_1500'], i['cafe_count_1000_price_2500'], i['cafe_count_1000_price_4000'], i['cafe_count_1000_price_high'], i['big_church_count_1000'], i['church_count_1000'], i['mosque_count_1000'], i['leisure_count_1000'], i['sport_count_1000'], i['market_count_1000'], i['green_part_1500'], i['prom_part_1500'], i['office_count_1500'], i['office_sqm_1500'], i['trc_count_1500'], i['trc_sqm_1500'], i['cafe_count_1500'], i['cafe_sum_1500_min_price_avg'], i['cafe_sum_1500_max_price_avg'], i['cafe_avg_price_1500'], i['cafe_count_1500_na_price'], i['cafe_count_1500_price_500'], i['cafe_count_1500_price_1000'], i['cafe_count_1500_price_1500'], i['cafe_count_1500_price_2500'], i['cafe_count_1500_price_4000'], i['cafe_count_1500_price_high'], i['big_church_count_1500'], i['church_count_1500'], i['mosque_count_1500'], i['leisure_count_1500'], i['sport_count_1500'], i['market_count_1500'], i['green_part_2000'], i['prom_part_2000'], i['office_count_2000'], i['office_sqm_2000'], i['trc_count_2000'], i['trc_sqm_2000'], i['cafe_count_2000'], i['cafe_sum_2000_min_price_avg'], i['cafe_sum_2000_max_price_avg'], i['cafe_avg_price_2000'], i['cafe_count_2000_na_price'], i['cafe_count_2000_price_500'], i['cafe_count_2000_price_1000'], i['cafe_count_2000_price_1500'], i['cafe_count_2000_price_2500'], i['cafe_count_2000_price_4000'], i['cafe_count_2000_price_high'], i['big_church_count_2000'], i['church_count_2000'], i['mosque_count_2000'], i['leisure_count_2000'], i['sport_count_2000'], i['market_count_2000'], i['green_part_3000'], i['prom_part_3000'], i['office_count_3000'], i['office_sqm_3000'], i['trc_count_3000'], i['trc_sqm_3000'], i['cafe_count_3000'], i['cafe_sum_3000_min_price_avg'], i['cafe_sum_3000_max_price_avg'], i['cafe_avg_price_3000'], i['cafe_count_3000_na_price'], i['cafe_count_3000_price_500'], i['cafe_count_3000_price_1000'], i['cafe_count_3000_price_1500'], i['cafe_count_3000_price_2500'], i['cafe_count_3000_price_4000'], i['cafe_count_3000_price_high'], i['big_church_count_3000'], i['church_count_3000'], i['mosque_count_3000'], i['leisure_count_3000'], i['sport_count_3000'], i['market_count_3000'], i['green_part_5000'], i['prom_part_5000'], i['office_count_5000'], i['office_sqm_5000'], i['trc_count_5000'], i['trc_sqm_5000'], i['cafe_count_5000'], i['cafe_sum_5000_min_price_avg'], i['cafe_sum_5000_max_price_avg'], i['cafe_avg_price_5000'], i['cafe_count_5000_na_price'], i['cafe_count_5000_price_500'], i['cafe_count_5000_price_1000'], i['cafe_count_5000_price_1500'], i['cafe_count_5000_price_2500'], i['cafe_count_5000_price_4000'], i['cafe_count_5000_price_high'], i['big_church_count_5000'], i['church_count_5000'], i['mosque_count_5000'], i['leisure_count_5000'], i['sport_count_5000'], i['market_count_5000'], i['price_doc']) for i in dr]
cur.executemany("INSERT INTO t (id, timestamp, full_sq, life_sq, floor, max_floor, material, build_year, num_room, kitch_sq, state, product_type, sub_area, area_m, raion_popul, green_zone_part, indust_part, children_preschool, preschool_quota, preschool_education_centers_raion, children_school, school_quota, school_education_centers_raion, school_education_centers_top_20_raion, hospital_beds_raion, healthcare_centers_raion, university_top_20_raion, sport_objects_raion, additional_education_raion, culture_objects_top_25, culture_objects_top_25_raion, shopping_centers_raion, office_raion, thermal_power_plant_raion, incineration_raion, oil_chemistry_raion, radiation_raion, railroad_terminal_raion, big_market_raion, nuclear_reactor_raion, detention_facility_raion, full_all, male_f, female_f, young_all, young_male, young_female, work_all, work_male, work_female, ekder_all, ekder_male, ekder_female, z0_6_all, z0_6_male, z0_6_female, z7_14_all, z7_14_male, z7_14_female, z0_17_all, z0_17_male, z0_17_female, z16_29_all, z16_29_male, z16_29_female, z0_13_all, z0_13_male, z0_13_female, raion_build_count_with_material_info, build_count_block, build_count_wood, build_count_frame, build_count_brick, build_count_monolith, build_count_panel, build_count_foam, build_count_slag, build_count_mix, raion_build_count_with_builddate_info, build_count_before_1920, build_count_1921_1945, build_count_1946_1970, build_count_1971_1995, build_count_after_1995, ID_metro, metro_min_avto, metro_km_avto, metro_min_walk, metro_km_walk, kindergarten_km, school_km, park_km, green_zone_km, industrial_km, water_treatment_km, cemetery_km, incineration_km, railroad_station_walk_km, railroad_station_walk_min, ID_railroad_station_walk, railroad_station_avto_km, railroad_station_avto_min, ID_railroad_station_avto, public_transport_station_km, public_transport_station_min_walk, water_km, water_1line, mkad_km, ttk_km, sadovoe_km, bulvar_ring_km, kremlin_km, big_road1_km, ID_big_road1, big_road1_1line, big_road2_km, ID_big_road2, railroad_km, railroad_1line, zd_vokzaly_avto_km, ID_railroad_terminal, bus_terminal_avto_km, ID_bus_terminal, oil_chemistry_km, nuclear_reactor_km, radiation_km, power_transmission_line_km, thermal_power_plant_km, ts_km, big_market_km, market_shop_km, fitness_km, swim_pool_km, ice_rink_km, stadium_km, basketball_km, hospice_morgue_km, detention_facility_km, public_healthcare_km, university_km, workplaces_km, shopping_centers_km, office_km, additional_education_km, preschool_km, big_church_km, church_synagogue_km, mosque_km, theater_km, museum_km, exhibition_km, catering_km, ecology, green_part_500, prom_part_500, office_count_500, office_sqm_500, trc_count_500, trc_sqm_500, cafe_count_500, cafe_sum_500_min_price_avg, cafe_sum_500_max_price_avg, cafe_avg_price_500, cafe_count_500_na_price, cafe_count_500_price_500, cafe_count_500_price_1000, cafe_count_500_price_1500, cafe_count_500_price_2500, cafe_count_500_price_4000, cafe_count_500_price_high, big_church_count_500, church_count_500, mosque_count_500, leisure_count_500, sport_count_500, market_count_500, green_part_1000, prom_part_1000, office_count_1000, office_sqm_1000, trc_count_1000, trc_sqm_1000, cafe_count_1000, cafe_sum_1000_min_price_avg, cafe_sum_1000_max_price_avg, cafe_avg_price_1000, cafe_count_1000_na_price, cafe_count_1000_price_500, cafe_count_1000_price_1000, cafe_count_1000_price_1500, cafe_count_1000_price_2500, cafe_count_1000_price_4000, cafe_count_1000_price_high, big_church_count_1000, church_count_1000, mosque_count_1000, leisure_count_1000, sport_count_1000, market_count_1000, green_part_1500, prom_part_1500, office_count_1500, office_sqm_1500, trc_count_1500, trc_sqm_1500, cafe_count_1500, cafe_sum_1500_min_price_avg, cafe_sum_1500_max_price_avg, cafe_avg_price_1500, cafe_count_1500_na_price, cafe_count_1500_price_500, cafe_count_1500_price_1000, cafe_count_1500_price_1500, cafe_count_1500_price_2500, cafe_count_1500_price_4000, cafe_count_1500_price_high, big_church_count_1500, church_count_1500, mosque_count_1500, leisure_count_1500, sport_count_1500, market_count_1500, green_part_2000, prom_part_2000, office_count_2000, office_sqm_2000, trc_count_2000, trc_sqm_2000, cafe_count_2000, cafe_sum_2000_min_price_avg, cafe_sum_2000_max_price_avg, cafe_avg_price_2000, cafe_count_2000_na_price, cafe_count_2000_price_500, cafe_count_2000_price_1000, cafe_count_2000_price_1500, cafe_count_2000_price_2500, cafe_count_2000_price_4000, cafe_count_2000_price_high, big_church_count_2000, church_count_2000, mosque_count_2000, leisure_count_2000, sport_count_2000, market_count_2000, green_part_3000, prom_part_3000, office_count_3000, office_sqm_3000, trc_count_3000, trc_sqm_3000, cafe_count_3000, cafe_sum_3000_min_price_avg, cafe_sum_3000_max_price_avg, cafe_avg_price_3000, cafe_count_3000_na_price, cafe_count_3000_price_500, cafe_count_3000_price_1000, cafe_count_3000_price_1500, cafe_count_3000_price_2500, cafe_count_3000_price_4000, cafe_count_3000_price_high, big_church_count_3000, church_count_3000, mosque_count_3000, leisure_count_3000, sport_count_3000, market_count_3000, green_part_5000, prom_part_5000, office_count_5000, office_sqm_5000, trc_count_5000, trc_sqm_5000, cafe_count_5000, cafe_sum_5000_min_price_avg, cafe_sum_5000_max_price_avg, cafe_avg_price_5000, cafe_count_5000_na_price, cafe_count_5000_price_500, cafe_count_5000_price_1000, cafe_count_5000_price_1500, cafe_count_5000_price_2500, cafe_count_5000_price_4000, cafe_count_5000_price_high, big_church_count_5000, church_count_5000, mosque_count_5000, leisure_count_5000, sport_count_5000, market_count_5000, price_doc) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);", to_db)


con.commit()
con.close()

